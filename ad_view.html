<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ad Player</title>
    <script src="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.js"></script>
    <style> 
        body { margin: 0; background: #000; overflow: hidden; font-family: monospace; color: #00ff00; } 
        #video-container { width: 100vw; height: 100vh; display: block; position: absolute; top:0; left:0; z-index: 10; }
        #status-log { 
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            text-align: center; z-index: 5; width: 90%;
        }
    </style>
</head>
<body>

    <div id="status-log">
        <h2>AD SYSTEM STATUS</h2>
        <p id="msg">Initializing...</p>
    </div>

    <div id="video-container">
        <video id="my-video">
            <source src="https://cdn.fluidplayer.com/videos/valerian-1080p.m4v" type="video/mp4"/>
        </video>
    </div>

    <script>
        // CONFIGURATION
        // Use the link from your SCREENSHOT (it looked more correct than the text one)
        const videoTag = 'https://homelybottle.com/d.mrf/zRddGmNov/Z/G/UY/Ve/me9DuDZJUP1/k/PST/Yd3yMajdQK2JNSTFQLtxN-jEcmyzNYD/Yw1GN-Qo';
        const cycleTime = 600000; // 10 Minutes (Success)
        const failTime = 30000;   // 30 Seconds (Retry)

        function updateStatus(text) {
            document.getElementById('msg').innerText = text;
            console.log(text);
        }

        var myPlayer = fluidPlayer('my-video', {
            layoutControls: {
                primaryColor: false, posterImage: false, playButtonShowing: false, 
                playPauseAnimation: false, fillToContainer: true, 
                autoPlay: true, mute: true
            },
            vastOptions: {
                allowVPAID: true, // Crucial for some Hilltop ads
                adList: [{ roll: 'preRoll', vastTag: videoTag }],
                vastAdvanced: {
                    noVastVideoCallback: function() { 
                        updateStatus("Ad Inventory Empty (No Fill). Retrying in 30s...");
                        scheduleRetry(failTime); 
                    },
                    vastVideoStartedCallback: function() {
                        updateStatus("Ad Playing...");
                    },
                    vastVideoEndedCallback: function() {
                        updateStatus("Ad Complete. Earnings Recorded.");
                        scheduleRetry(cycleTime);
                    }
                }
            }
        });

        function scheduleRetry(ms) {
            // Hide player so we can see the status text
            document.getElementById('video-container').style.visibility = 'hidden';
            
            let seconds = ms / 1000;
            let countdown = setInterval(function() {
                seconds--;
                if(document.getElementById('msg').innerText.includes("Empty") || document.getElementById('msg').innerText.includes("Earnings")) {
                     document.getElementById('msg').innerText += "."; // Just animate dots
                }
                if (seconds <= 0) {
                    clearInterval(countdown);
                    window.location.reload();
                }
            }, 1000);
        }

        // Generic Error Handler
        myPlayer.on('error', function() { 
            updateStatus("Player Error. reloading..."); 
            scheduleRetry(failTime); 
        });

    </script>
</body>
</html>
